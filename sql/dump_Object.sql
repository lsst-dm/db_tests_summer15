SELECT
    s.deepSourceId,
    s.ra,
    s.decl,
    s.raVar,
    s.declVar,
    s.radeclCov,
    -- Dump calibrated rather than raw fluxes.
    scisql_dnToFlux(s.psfFlux, c.fluxMag0),
    scisql_dnToFluxSigma(s.psfFlux, s.psfFluxSigma, c.fluxMag0, c.fluxMag0Sigma),
    scisql_dnToFlux(s.apFlux, c.fluxMag0),
    scisql_dnToFluxSigma(s.apFlux, s.apFluxSigma, c.fluxMag0, c.fluxMag0Sigma),
    scisql_dnToFlux(s.modelFlux, c.fluxMag0),
    scisql_dnToFluxSigma(s.modelFlux, s.modelFluxSigma, c.fluxMag0, c.fluxMag0Sigma),
    scisql_dnToFlux(s.instFlux, c.fluxMag0),
    scisql_dnToFluxSigma(s.instFlux, s.instFluxSigma, c.fluxMag0, c.fluxMag0Sigma),
    s.apCorrection,
    s.apCorrectionSigma,
    s.shapeIx,
    s.shapeIy,
    s.shapeIxVar,
    s.shapeIyVar,
    s.shapeIxIyCov,
    s.shapeIxx,
    s.shapeIyy,
    s.shapeIxy,
    s.shapeIxxVar,
    s.shapeIyyVar,
    s.shapeIxyVar,
    s.shapeIxxIyyCov,
    s.shapeIxxIxyCov,
    s.shapeIyyIxyCov,
    s.extendedness,
    s.flagNegative,
    s.flagBadMeasCentroid,
    s.flagPixEdge,
    s.flagPixInterpAny,
    s.flagPixInterpCen,
    s.flagPixSaturAny,
    s.flagPixSaturCen,
    s.flagBadPsfFlux,
    s.flagBadApFlux,
    s.flagBadModelFlux,
    s.flagBadInstFlux,
    s.flagBadCentroid,
    s.flagBadShape
FROM
    DC_W13_Stripe82.DeepSource AS s INNER JOIN
    DC_W13_Stripe82.DeepCoadd AS c ON (s.deepCoaddId = c.deepCoaddId) INNER JOIN
    qserv_in2p3_2015.DeepSourceIds AS i ON (s.deepSourceId = i.deepSourceId);
